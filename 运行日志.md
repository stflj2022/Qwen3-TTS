# 千问语音克隆 - 运行日志

**日期：** 2026-01-25
**状态：** 已暂停，待继续

---

## 本次运行记录

### 任务信息
- **导入文本字符数：** 50265 字符
- **已生成音频片段：** 196 个
- **输出格式：** WAV + OPUS
- **最后生成时间：** 19:49

### 已生成文件
```
outputs/
├── clone_clone_001.wav ~ clone_clone_196.wav
├── clone_clone_001.opus ~ clone_clone_196.opus
```

### 系统配置
- **启动命令：** `./启动WebUI.sh`
- **端口：** 7860
- **访问地址：** http://localhost:7860/
- **工作目录：** `/home/wu/文档/千问语音克隆`

### 模型状态
- ✅ CustomVoice (预置音色) - 已加载
- ✅ Base (声音克隆) - 已加载
- ✅ VoiceDesign (声音设计) - 已加载

---

## 下次启动

### 启动步骤
```bash
cd /home/wu/文档/千问语音克隆
./启动WebUI.sh
```

### 继续任务
1. 打开 http://localhost:7860/
2. 检查文本是否还保留（可能需要重新导入）
3. 确认从哪个片段继续生成

### 注意事项
- 已生成的音频文件保存在 `outputs/` 目录
- 克隆音色保存在 `cloned_voices/` 目录
- 进程已正常停止，休眠/关机安全

---

## 文件统计

| 类型 | 数量 |
|------|------|
| WAV 文件 | 196 个 |
| OPUS 文件 | 196 个 |
| 总音频时长 | 约 98-130 分钟（估算） |

---

---

## 2026-01-26 更新

### 重新运行记录
- **启动时间：** 04:06
- **停止时间：** 04:20
- **状态：** 重新开始，未继续昨日任务
- **新覆盖文件：** 001 ~ 005 (已覆盖)
- **保留文件：** 006 ~ 200 (昨日版本)
- **总文件数：** 200 个 WAV

### 问题
系统重新从 001 开始生成，覆盖了前 5 个文件。006-200 仍是昨天生成的版本。

**记录时间：** 2026-01-26 04:20

---

## 2026-01-26 继续更新

### 代码修改记录

#### 1. 声音设计标签页功能增强
- **位置1:** `/home/wu/文档/千问语音克隆`
- **位置2:** `/home/wu/视频/千问语音克隆`
- **修改内容:** 添加"保存使用新生成的音色"选项和"我的克隆音色"区域

#### 2. OPUS 格式自动合并支持
- **修改:** 批量生成时 OPUS 格式也支持自动合并
- **实现方式:** 先合并 WAV，再转 OPUS

#### 3. 音频质量修复
- **问题:** 合并后音色失真、语速变慢、有噪音
- **原因:** AudioSegment 直接从 numpy 字节数组创建时使用了错误的 sample_width
- **修复:** 始终先用 sf.write() 保存 WAV，再用 AudioSegment.from_wav() 加载

#### 4. 声音设计卡住修复
- **问题:** 点击生成后运行3秒卡住
- **原因:** generate_voice_design 缺少 do_sample=True 参数
- **修复:** 3处调用全部添加 do_sample=True
- **影响文件:** webui.py (位置1和位置2)

### 已合并音频
- **目录:** `outputs/夏一可201----/`
- **文件数:** 8 个 OPUS
- **总时长:** 2分37秒
- **输出:** `夏一可201----_合并.opus`

### 模型状态
- ✅ CustomVoice 预置音色模型 - 已安装
- ✅ Base 声音克隆模型 - 已安装
- ✅ VoiceDesign 声音设计模型 - 已安装

**记录时间：** 2026-01-26 05:50
